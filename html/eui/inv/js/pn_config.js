dwap.page.unique=function(a){var t=[],e=[];return a.map(function(a){t.indexOf(a.value)<0&&(t.push(a.value),e.push(a))}),e},dwap.page.param_combos=function(){return{CLASS_ID:$("#PARAM_CLASS_ID").combobox("getValue"),TYPE_ID:$("#PARAM_TYPE_ID").combobox("getValue")}},dwap.page.addbut=function(a,t){setTimeout(function(){a.datagrid("options").tbar.dgre_add.linkbutton(t)})},dwap.page.status=function(a){var t=$("#o"+a).datagrid("options");t.tbar.dgre_add.hide(),t.tbar.dgre_del.hide(),t.tbar.dgre_edit.hide()},dwap.page.dgload=function(a,t){a.datagrid("options").queryParams.CLASS_ID=t.value,a.datagrid("reload")},dwap.page.param_select=function(){var a=$("#dgparams"),t=dwap.page.param_combos();a.datagrid("options").queryParams.TYPE_ID=t.TYPE_ID,a.datagrid("options").queryParams.CLASS_ID=t.CLASS_ID,a.datagrid("reload")},$(document).ready(function(){ajaxget("/",{_sqlid:"admin^bhave",_func:"get",appid:"inv^sa_parts"},function(a){dwap.bhave=a}),$("#CLASS_ID").combobox({onLoadSuccess:function(a){$("#PARAM_CLASS_ID").combobox("loadData",a),$("#TYPE_CLASS_ID").combobox("loadData",a),$("#PART_CLASS_ID").combobox("loadData",a),$("#DESC_CLASS_ID").combobox("loadData",a)}}),$("#PARAM_CLASS_ID").combobox({loadFilter:dwap.page.unique,onSelect:dwap.page.param_select}),$("#TYPE_CLASS_ID").combobox({loadFilter:dwap.page.unique,onSelect:function(a){dwap.page.dgload($("#dgtypes"),a)}}),$("#PART_CLASS_ID").combobox({loadFilter:dwap.page.unique,onSelect:function(a){dwap.page.dgload($("#dgpart"),a)}}),$("#DESC_CLASS_ID").combobox({loadFilter:dwap.page.unique,onSelect:function(a){dwap.page.dgload($("#dgdesc"),a)}}),$("#PARAM_TYPE_ID").combobox({loadFilter:dwap.page.unique,onSelect:dwap.page.param_select}),$("#dgparams").datagrid({striped:!0,rownumbers:!0,url:"/",queryParams:{_func:"get",_sqlid:"inv^pn_classparam",_dgrid:!0,TYPE_ID:"",CLASS_ID:""},onBeforeLoad:function(a){return dwap.page.addbut($(this),"disable"),""!=a.TYPE_ID&&""!=a.CLASS_ID},onLoadSuccess:function(){dwap.page.addbut($(this),"enable")},columns:[[{field:"CLASS_ID",title:"Class"},{field:"TYPE_ID",title:"Type"},{field:"PARA_ID",title:"Param ID",editor:{type:"textbox",options:{required:!0}}},{field:"CODE_STR",title:"Code",editor:{type:"textbox",options:{required:!0}}}]]}).datagrid("rowEditor",{twoColumns:!1,editor:"form",addData:dwap.page.param_combos,onEndEdit:function(a,t,e){var d=$(this);d.datagrid("options").queryParams;t._sqlid="inv^pn_classparam",cl(t),ajaxget("/",t,function(a){d.datagrid("reload")})}}),$("#dgtypes").datagrid({url:"/",queryParams:{_func:"get",_sqlid:"inv^pn_classtype",_dgrid:!0,CLASS_ID:""},onBeforeLoad:function(a){return dwap.page.addbut($(this),"disable"),""!=a.CLASS_ID},onLoadSuccess:function(){dwap.page.addbut($(this),"enable")},columns:[[{field:"CLASS_ID",title:"Class"},{field:"TYPE_ID",title:"Type ID",editor:"text"},{field:"DESCRIPTION",title:"Description",editor:"text"},{field:"DESC_RULE",title:"Position",editor:{type:"combobox",options:{panelHeight:"auto",data:[{value:"NONE",text:"NONE"},{value:"PREFIX",text:"PREFIX"},{value:"SUFFIX",text:"SUFFIX"}]}}}]]}).datagrid("rowEditor",{twoColumns:!1,editor:"form",addData:function(){return{CLASS_ID:$("#TYPE_CLASS_ID").combobox("getValue")}},onEndEdit:function(a,t,e){t.TYPE_ID=t.TYPE_ID.toUpperCase(),t._sqlid="inv^pn_classtype",cl(t),ajaxget("/",t,function(a){cl(a)})}}),$("#dgpart").datagrid({url:"/",queryParams:{_func:"get",_sqlid:"inv^pn_idformula",_dgrid:!0,CLASS_ID:""},onBeforeLoad:function(a){return dwap.page.addbut($(this),"disable"),""!=a.CLASS_ID},onLoadSuccess:function(a){var t=[];a.rows.map(function(a){t.push(a.DATA_STR)}),$("#ID_GEN").textbox("setValue",t.join("")),dwap.page.addbut($(this),"enable")},columns:[[{field:"SEQ_NO",title:"SEQ",width:60,align:"center",editor:{type:"numberbox",options:{readonly:!0}}},{field:"CLASS_ID",title:"Class",width:100},{field:"FIELD_TYPE",title:"Field Type",width:150,editor:{type:"combobox",options:{panelHeight:"auto",data:[{value:"FIXED",text:"FIXED"},{value:"DATA",text:"DATA"}]}}},{field:"DATA_STR",title:"Field Data",editor:{type:"textbox",options:{cls:"upper",validType:["length[1,25]"]}},width:150,required:!0}]]}).datagrid("rowEditor",{twoColumns:!1,editor:"form",addData:function(){var a=10*($("#dgpart").datagrid("getRows").length+1);return{CLASS_ID:$("#PART_CLASS_ID").combobox("getValue"),SEQ_NO:a}},onEndEdit:function(a,t,e){t._sqlid="inv^pn_idformula",ajaxget("/",t,function(a){cl(a)})}}),$("#dgdesc").datagrid({url:"/",queryParams:{_func:"get",_sqlid:"inv^pn_descformula",_dgrid:!0,CLASS_ID:""},onBeforeLoad:function(a){return dwap.page.addbut($(this),"disable"),""!=a.CLASS_ID},onLoadSuccess:function(a){dwap.page.addbut($(this),"enable");var t=[];a.rows.map(function(a){t.push(a.DATA_STR)}),$("#DESC_GEN").textbox("setValue",t.join("")),dwap.page.addbut($(this),"enable")},columns:[[{field:"SEQ_NO",title:"SEQ",width:60,align:"center",editor:{type:"numberbox",options:{readonly:!0}}},{field:"CLASS_ID",title:"Class",width:100},{field:"FIELD_TYPE",title:"Field Type",width:150,editor:{type:"combobox",options:{panelHeight:"auto",data:[{value:"FIXED",text:"FIXED"},{value:"DATA",text:"DATA"}]}}},{field:"DATA_STR",title:"Field Data",editor:{type:"textbox",options:{cls:"upper",validType:["length[1,25]"]}},width:150}]]}).datagrid("rowEditor",{twoColumns:!1,editor:"form",addData:function(){var a=10*($("#dgdesc").datagrid("getRows").length+1);return{CLASS_ID:$("#DESC_CLASS_ID").combobox("getValue"),SEQ_NO:a}},onEndEdit:function(a,t,e){t._sqlid="inv^pn_descformula",cl(t),ajaxget("/",t,function(a){cl(a)})}})});