dwap.page.status=function(){$("#otddg").datagrid("options");$("#otdopen").linkbutton("enable")},$("#otdwin").window({minimizable:!1,draggable:!0,modal:!1,onOpen:function(){var t=$("#cpdg").datagrid("getSelected"),e={_sqlid:"inv^cprop_items_return",_func:"get",CP_ID:t.CP_ID,CP_LINE_NO:t.LINE_NO,_dgrid:"y"};ajaxget("/",e,function(t){$("#otddg").datagrid("loadData",t)})},onBeforeClose:function(){if(!$("#otddg").datagrid("options").tbar.dgre_ok.hasClass("l-btn-disabled"))return beep("error"),alert("Please finish editing."),!1}}),$("#otddg").datagrid("rowEditor",{editor:"form",fitColumns:!0,singleSelect:!0,striped:!0,fit:!0,addData:{LINE_NO:"$autonum:1",CP_ID:"#CP_ID"},columns:[[{field:"CP_ID",title:"CP ID ",width:100,hidden:!0},{field:"CP_LINE_NO",title:"CP Line#",width:50,hidden:!0},{field:"LINE_NO",title:"#",width:30,fixed:!0,align:"center"},{field:"QTY_RETURN",title:"Qty Return ",width:20,fixed:!1,editor:{type:"numberspinner",options:{required:!0,min:1,value:0,precision:2}}},{field:"DATE_RETURN",title:"Date Return ",width:30,fixed:!1,formatter:eui.date,editor:{type:"datebox",options:{required:!0}}}]]}).datagrid({onEndEdit:function(t,e,d){var i=$("#cpdg").datagrid("getSelected");e._sqlid="inv^cprop_items_return",e.CP_LINE_NO=i.LINE_NO,e.CP_ID=e.CP_ID,e.LINE_NO=e.LINE_NO,e.QTY_RETURN=e.QTY_RETURN,e.DATE_RETURN=e.DATE_RETURN;var n=i.QTY_RECV,o=0;$(this).datagrid("getRows").map(function(t){var e=1*t.QTY_RETURN;o+=e}),o>n?(msgbox("Quantity returned,"+o+" exceeds received,"+n),$("#otddg").datagrid("destroy")):ajaxget("/",e,function(t){t.error&&msgbox(t.msg),$("#otddg").datagrid("reload")})}}),$(document).ready(function(){toolbut([{id:"otdopen",iconCls:"icon-gantt",text:"Return",disabled:!0,noText:!1,onClick:function(){$("#otdwin").window("open")}}]),dwap.page.status()});